{"version":3,"file":"Table.es.js","sources":["../../../src/components/Table/Table.tsx"],"sourcesContent":["/* (c) Copyright Frontify Ltd., all rights reserved. */\n\nimport {\n    Cell as AriaCell,\n    Column as AriaColumn,\n    Row as AriaRow,\n    TableBody,\n    TableHeader,\n    TableStateProps,\n    useTableState,\n} from '@react-stately/table';\nimport { Key, ReactNode, useRef, useState } from 'react';\nimport { TableCell, TableCellType } from './TableCell';\nimport { TableColumnHeader, TableColumnHeaderType } from './TableColumnHeader';\nimport { TableHeaderRow } from './TableHeaderRow';\nimport { TableRow } from './TableRow';\n\nexport enum SelectionMode {\n    NoSelect = 'none',\n    SingleSelect = 'single',\n    MultiSelect = 'multiple',\n}\n\nexport type Cell = {\n    sortId: string | number;\n    value: ReactNode;\n    ariaLabel?: string;\n};\n\nexport type Column = {\n    name: string;\n    key: string;\n    sortable?: boolean;\n};\n\nexport type Row = {\n    key: Key;\n    // cell keys have to correspond to column key values\n    // e.g. Column { name: 'User', key: 'user' } ==> Row Cell { user: { id: 'anna', value: 'Anna' } }\n    cells: Record<string, Cell>;\n    actionElements?: ReactNode;\n};\n\nexport type TableProps = {\n    columns: Column[];\n    rows: Row[];\n    onSelectionChange?: (ids?: Key[]) => void;\n    onSortChange?: (column: string, direction?: SortDirection) => void;\n    selectionMode?: SelectionMode;\n    selectedRowIds?: Key[];\n    ariaLabel?: string;\n    children?: ReactNode;\n};\n\nexport enum SortDirection {\n    Ascending = 'ascending',\n    Descending = 'descending',\n}\n\nconst DEFAULT_SORT_ORDER = SortDirection.Descending;\n\ntype SortType = {\n    sortedColumnKey?: string;\n    sortOrder?: SortDirection;\n};\n\n/* react-aria hook props types are inexplicitly typed */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nconst mapToTableAriaProps = (columns: Column[], rows: Row[], hasSort = false): TableStateProps<any> => {\n    return {\n        children: [\n            <TableHeader key=\"table-header\" columns={columns}>\n                {(column) => {\n                    const allowsSorting = !!(column.sortable && hasSort);\n                    return <AriaColumn allowsSorting={allowsSorting}>{column.name}</AriaColumn>;\n                }}\n            </TableHeader>,\n            <TableBody key=\"table-body\" items={rows}>\n                {(item) => (\n                    <AriaRow>\n                        {(columnKey) => (\n                            <AriaCell key={`${item.key}-${columnKey}`} aria-label={item.cells[columnKey].ariaLabel}>\n                                {item.cells[columnKey].value}\n                            </AriaCell>\n                        )}\n                    </AriaRow>\n                )}\n            </TableBody>,\n        ],\n    };\n};\n\nconst getRowFromId = (rows: Row[], id: Key) => rows.find(({ key }) => key === id) || null;\n\nconst getAllRowIds = (rows: Row[]): Key[] => rows.map(({ key: id }) => id);\n\nexport const Table = ({\n    columns,\n    rows,\n    onSelectionChange,\n    selectionMode = SelectionMode.NoSelect,\n    onSortChange: onSort,\n    selectedRowIds = [],\n    ariaLabel = 'Table',\n}: TableProps) => {\n    const isSelectTable = selectionMode === SelectionMode.SingleSelect || selectionMode === SelectionMode.MultiSelect;\n    const [{ sortedColumnKey, sortOrder }, setSortedColumn] = useState<SortType>({\n        sortedColumnKey: undefined,\n        sortOrder: undefined,\n    });\n\n    const onSortChange = (column: string, direction?: SortDirection) => {\n        const inverseSortDirection =\n            direction === SortDirection.Ascending ? SortDirection.Descending : SortDirection.Ascending;\n        setSortedColumn({\n            sortedColumnKey: column,\n            sortOrder: sortedColumnKey !== column ? DEFAULT_SORT_ORDER : inverseSortDirection,\n        });\n        onSort?.(column, direction);\n    };\n\n    const rowIds = getAllRowIds(rows);\n    const ref = useRef<HTMLTableElement | null>(null);\n    const props = mapToTableAriaProps(columns, rows, !!onSort);\n    const state = useTableState({\n        ...props,\n        selectionMode,\n        showSelectionCheckboxes: isSelectTable,\n    });\n    const { collection } = state;\n\n    return (\n        <div className=\"tw-w-full tw-max-h-96 sm:tw-max-h-full\">\n            <table\n                aria-label={ariaLabel}\n                ref={ref}\n                className=\"tw-border-collapse tw-table-auto tw-w-full tw-min-w-max tw-text-left dark:tw-bg-black-100 dark:tw-text-black-20\"\n            >\n                <thead>\n                    {collection.headerRows.map((headerRow) => (\n                        <TableHeaderRow key={headerRow.key}>\n                            {[...headerRow.childNodes].map((column) => {\n                                const headerType = column.props.isSelectionCell\n                                    ? TableColumnHeaderType.SelectAll\n                                    : TableColumnHeaderType.Default;\n\n                                return (\n                                    <TableColumnHeader\n                                        key={column.key}\n                                        column={column}\n                                        type={headerType}\n                                        rowIds={rowIds}\n                                        sortDirection={sortOrder}\n                                        selectionMode={selectionMode}\n                                        isColumnSorted={sortedColumnKey === column.key}\n                                        handleSortChange={onSortChange}\n                                        setSelectedRows={onSelectionChange}\n                                    />\n                                );\n                            })}\n                            <td />\n                        </TableHeaderRow>\n                    ))}\n                </thead>\n                <tbody className=\"tw-relative tw-z-[-1] sm:tw-z-auto\">\n                    {[...collection.body.childNodes].map((ariaRow) => {\n                        const row = getRowFromId(rows, ariaRow.key);\n\n                        return (\n                            <TableRow key={ariaRow.key} isSelected={selectedRowIds.includes(ariaRow.key)}>\n                                {[...ariaRow.childNodes].map((cell) => {\n                                    const cellType = cell.props.isSelectionCell\n                                        ? TableCellType.Checkbox\n                                        : TableCellType.Default;\n                                    return (\n                                        <TableCell\n                                            key={cell.key}\n                                            cell={cell}\n                                            selectionMode={selectionMode}\n                                            type={cellType}\n                                            isChecked={selectedRowIds.includes(ariaRow.key)}\n                                            selectedRows={selectedRowIds}\n                                            setSelectedRows={onSelectionChange}\n                                        />\n                                    );\n                                })}\n                                {row?.actionElements && (\n                                    <td className=\"tw-sticky tw-right-0 tw-z-10\" data-test-id=\"table-actions\">\n                                        <div className=\"tw-float-right hover:tw-bg-gradient-to-r hover:tw-from-transparent hover:tw-to-black-0 dark:hover:tw-to-black-95 tw-py-4 tw-pr-8 tw-pl-4\">\n                                            {row.actionElements}\n                                        </div>\n                                    </td>\n                                )}\n                            </TableRow>\n                        );\n                    })}\n                </tbody>\n            </table>\n        </div>\n    );\n};\nTable.displayName = 'FondueTable';\n"],"names":["SelectionMode","SortDirection","DEFAULT_SORT_ORDER","mapToTableAriaProps","columns","rows","hasSort","jsx","TableHeader","column","allowsSorting","AriaColumn","TableBody","item","AriaRow","columnKey","AriaCell","getRowFromId","id","key","getAllRowIds","Table","onSelectionChange","selectionMode","onSort","selectedRowIds","ariaLabel","isSelectTable","sortedColumnKey","sortOrder","setSortedColumn","useState","onSortChange","direction","rowIds","ref","useRef","props","state","useTableState","collection","jsxs","headerRow","TableHeaderRow","headerType","TableColumnHeaderType","TableColumnHeader","ariaRow","row","TableRow","cell","cellType","TableCellType","TableCell"],"mappings":"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"}