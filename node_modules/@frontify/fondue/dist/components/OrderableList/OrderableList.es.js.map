{"version":3,"file":"OrderableList.es.js","sources":["../../../src/components/OrderableList/OrderableList.tsx"],"sourcesContent":["/* (c) Copyright Frontify Ltd., all rights reserved. */\n\nimport { useEffect, useMemo, useState } from 'react';\n\nimport { OrderableListItem, OrderableListItemStyle, OrderableListProps } from './types';\nimport { useId } from '@react-aria/utils';\nimport { OnTreeDropCallback, Tree, TreeItem } from '..';\nimport { DraggableItem } from '@utilities/dnd/types';\n\nconst listItemsCompareFn = <T extends object>(itemA: OrderableListItem<T>, itemB: OrderableListItem<T>): number => {\n    if (itemA.sort === null && itemB.sort === null) {\n        return 1;\n    }\n    if (itemA.sort === null) {\n        return 1;\n    }\n    if (itemB.sort === null) {\n        return -1;\n    }\n\n    return itemA.sort - itemB.sort;\n};\n\nconst moveItem = <T extends object>(\n    id: string,\n    newPosition: number | null,\n    items: DraggableItem<T>[],\n): DraggableItem<T>[] => {\n    const theItem = items.find((item) => item.id === id) as DraggableItem<T>;\n\n    return theItem ? [{ ...theItem, sort: newPosition }] : [];\n};\n\nexport const OrderableList = <T extends object>({\n    onMove,\n    dragDisabled,\n    items,\n    dragHandlerPosition = 'none',\n    itemStyle,\n    selectedId,\n    renderContent,\n    'data-test-id': dataTestId = 'orderable-list',\n}: OrderableListProps<T>) => {\n    const [itemsState, setItemsState] = useState(items);\n    const listId = useId();\n    const isDraggable = !dragDisabled;\n\n    useEffect(() => {\n        // sort the incoming items\n        const itemsClone = [...items];\n        itemsClone.sort(listItemsCompareFn);\n        setItemsState(itemsClone);\n    }, [items]);\n\n    const handleDrop: OnTreeDropCallback = (dropArgs) => {\n        onMove(moveItem(dropArgs.id, dropArgs.sort, itemsState));\n    };\n\n    const treeItemStyle = useMemo(() => {\n        return {\n            spacingY: 'small',\n            contentHight: 'content-fit',\n            shadow: 'small',\n            borderRadius: 'medium',\n            borderWidth: 'x-small',\n            borderStyle: 'solid',\n            activeColorStyle: 'soft',\n            ...itemStyle,\n        } as OrderableListItemStyle;\n    }, [itemStyle]);\n\n    return (\n        <Tree\n            draggable={isDraggable}\n            id={listId}\n            onDrop={handleDrop}\n            data-test-id={dataTestId}\n            selectedIds={selectedId ? [selectedId] : []}\n            itemStyle={treeItemStyle}\n            showDragHandlerOnHoverOnly={!isDraggable}\n            dragHandlerPosition={!isDraggable ? 'none' : dragHandlerPosition}\n            showContentWhileDragging={true}\n        >\n            {itemsState.map((item) => {\n                const identifier = `collection-item-${item.id}`;\n                return (\n                    <TreeItem\n                        data-test-id={`${dataTestId}-item`}\n                        id={item.id}\n                        key={identifier}\n                        type=\"collection-item\"\n                        accepts=\"collection-item\"\n                        expandable={false}\n                        levelConstraint={0}\n                        contentComponent={renderContent(item)}\n                    />\n                );\n            })}\n        </Tree>\n    );\n};\nOrderableList.displayName = 'FondueOrderableList';\n"],"names":["listItemsCompareFn","itemA","itemB","moveItem","id","newPosition","items","theItem","item","OrderableList","onMove","dragDisabled","dragHandlerPosition","itemStyle","selectedId","renderContent","dataTestId","itemsState","setItemsState","useState","listId","useId","isDraggable","useEffect","itemsClone","handleDrop","dropArgs","treeItemStyle","useMemo","jsx","Tree","identifier","TreeItem"],"mappings":";;;;;AASA,MAAMA,IAAqB,CAAmBC,GAA6BC,MACnED,EAAM,SAAS,QAAQC,EAAM,SAAS,QAGtCD,EAAM,SAAS,OACR,IAEPC,EAAM,SAAS,OACR,KAGJD,EAAM,OAAOC,EAAM,MAGxBC,IAAW,CACbC,GACAC,GACAC,MACqB;AACrB,QAAMC,IAAUD,EAAM,KAAK,CAACE,MAASA,EAAK,OAAOJ,CAAE;AAE5C,SAAAG,IAAU,CAAC,EAAE,GAAGA,GAAS,MAAMF,EAAA,CAAa,IAAI;AAC3D,GAEaI,IAAgB,CAAmB;AAAA,EAC5C,QAAAC;AAAA,EACA,cAAAC;AAAA,EACA,OAAAL;AAAA,EACA,qBAAAM,IAAsB;AAAA,EACtB,WAAAC;AAAA,EACA,YAAAC;AAAA,EACA,eAAAC;AAAA,EACA,gBAAgBC,IAAa;AACjC,MAA6B;AACzB,QAAM,CAACC,GAAYC,CAAa,IAAIC,EAASb,CAAK,GAC5Cc,IAASC,KACTC,IAAc,CAACX;AAErB,EAAAY,EAAU,MAAM;AAEN,UAAAC,IAAa,CAAC,GAAGlB,CAAK;AAC5B,IAAAkB,EAAW,KAAKxB,CAAkB,GAClCkB,EAAcM,CAAU;AAAA,EAAA,GACzB,CAAClB,CAAK,CAAC;AAEJ,QAAAmB,IAAiC,CAACC,MAAa;AACjD,IAAAhB,EAAOP,EAASuB,EAAS,IAAIA,EAAS,MAAMT,CAAU,CAAC;AAAA,EAAA,GAGrDU,IAAgBC,EAAQ,OACnB;AAAA,IACH,UAAU;AAAA,IACV,cAAc;AAAA,IACd,QAAQ;AAAA,IACR,cAAc;AAAA,IACd,aAAa;AAAA,IACb,aAAa;AAAA,IACb,kBAAkB;AAAA,IAClB,GAAGf;AAAA,EAAA,IAER,CAACA,CAAS,CAAC;AAGV,SAAA,gBAAAgB;AAAA,IAACC;AAAA,IAAA;AAAA,MACG,WAAWR;AAAA,MACX,IAAIF;AAAA,MACJ,QAAQK;AAAA,MACR,gBAAcT;AAAA,MACd,aAAaF,IAAa,CAACA,CAAU,IAAI,CAAC;AAAA,MAC1C,WAAWa;AAAA,MACX,4BAA4B,CAACL;AAAA,MAC7B,qBAAsBA,IAAuBV,IAAT;AAAA,MACpC,0BAA0B;AAAA,MAEzB,UAAAK,EAAW,IAAI,CAACT,MAAS;AAChB,cAAAuB,IAAa,mBAAmBvB,EAAK,EAAE;AAEzC,eAAA,gBAAAqB;AAAA,UAACG;AAAA,UAAA;AAAA,YACG,gBAAc,GAAGhB,CAAU;AAAA,YAC3B,IAAIR,EAAK;AAAA,YAET,MAAK;AAAA,YACL,SAAQ;AAAA,YACR,YAAY;AAAA,YACZ,iBAAiB;AAAA,YACjB,kBAAkBO,EAAcP,CAAI;AAAA,UAAA;AAAA,UAL/BuB;AAAA,QAAA;AAAA,MAMT,CAEP;AAAA,IAAA;AAAA,EAAA;AAGb;AACAtB,EAAc,cAAc;"}