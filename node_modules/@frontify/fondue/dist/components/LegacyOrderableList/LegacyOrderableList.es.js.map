{"version":3,"file":"LegacyOrderableList.es.js","sources":["../../../src/components/LegacyOrderableList/LegacyOrderableList.tsx"],"sourcesContent":["/* (c) Copyright Frontify Ltd., all rights reserved. */\n\nimport { Fragment, useEffect, useState } from 'react';\n\nimport { LegacyCollectionItem } from './LegacyCollectionItem';\nimport { LegacyOrderableListItem, LegacyOrderableListProps } from './types';\nimport { DropZone } from '@components/DropZone';\nimport { HTML5Backend } from 'react-dnd-html5-backend';\nimport { DndProvider } from 'react-dnd';\nimport { moveItems } from '@utilities/dnd';\nimport { useId } from '@react-aria/utils';\nimport { CollisionPosition } from '..';\n\nconst listItemsCompareFn = <T extends object>(\n    itemA: LegacyOrderableListItem<T>,\n    itemB: LegacyOrderableListItem<T>,\n): number => {\n    if (itemA.sort === null && itemB.sort === null) {\n        return 1;\n    }\n    if (itemA.sort === null) {\n        return 1;\n    }\n    if (itemB.sort === null) {\n        return -1;\n    }\n\n    return itemA.sort - itemB.sort;\n};\n\nexport const LegacyOrderableList = <T extends object>({\n    onMove,\n    dragDisabled,\n    items,\n    renderContent,\n    'data-test-id': dataTestId = 'orderable-list',\n}: LegacyOrderableListProps<T>) => {\n    const [itemsState, setItemsState] = useState(items);\n    const listId = useId();\n\n    useEffect(() => {\n        // sort the incoming items\n        const itemsClone = [...items];\n        itemsClone.sort(listItemsCompareFn);\n        setItemsState(itemsClone);\n    }, [items]);\n\n    const handleDrop = (\n        targetItem: LegacyOrderableListItem<T>,\n        sourceItem: LegacyOrderableListItem<T>,\n        position: CollisionPosition,\n    ) => {\n        const modifiedItems = moveItems(targetItem, sourceItem, position, itemsState);\n        onMove(modifiedItems);\n    };\n\n    return (\n        <DndProvider backend={HTML5Backend}>\n            <div className=\"tw-outline-none\" data-test-id={dataTestId}>\n                {itemsState.map((item, index) => (\n                    <Fragment key={`dropzone-orderable-list-key-${index}`}>\n                        <DropZone\n                            key={`orderable-list-item-${index}-before`}\n                            data={{\n                                targetItem: item,\n                                position: 'before' as const,\n                            }}\n                            onDrop={handleDrop}\n                            accept={listId}\n                        />\n                        <LegacyCollectionItem\n                            key={item.id}\n                            dragDisabled={dragDisabled}\n                            item={item}\n                            renderContent={renderContent}\n                            listId={listId}\n                        />\n                        {index === items.length - 1 && (\n                            <DropZone\n                                key={`orderable-list-item-${index}-after`}\n                                data={{\n                                    targetItem: item,\n                                    position: 'after' as const,\n                                }}\n                                onDrop={handleDrop}\n                                accept={listId}\n                            />\n                        )}\n                    </Fragment>\n                ))}\n            </div>\n        </DndProvider>\n    );\n};\nLegacyOrderableList.displayName = 'FondueLegacyOrderableList';\n"],"names":["listItemsCompareFn","itemA","itemB","LegacyOrderableList","onMove","dragDisabled","items","renderContent","dataTestId","itemsState","setItemsState","useState","listId","useId","useEffect","itemsClone","handleDrop","targetItem","sourceItem","position","modifiedItems","moveItems","DndProvider","HTML5Backend","jsx","item","index","Fragment","DropZone","LegacyCollectionItem"],"mappings":";;;;;;;;AAaA,MAAMA,IAAqB,CACvBC,GACAC,MAEID,EAAM,SAAS,QAAQC,EAAM,SAAS,QAGtCD,EAAM,SAAS,OACR,IAEPC,EAAM,SAAS,OACR,KAGJD,EAAM,OAAOC,EAAM,MAGjBC,IAAsB,CAAmB;AAAA,EAClD,QAAAC;AAAA,EACA,cAAAC;AAAA,EACA,OAAAC;AAAA,EACA,eAAAC;AAAA,EACA,gBAAgBC,IAAa;AACjC,MAAmC;AAC/B,QAAM,CAACC,GAAYC,CAAa,IAAIC,EAASL,CAAK,GAC5CM,IAASC;AAEf,EAAAC,EAAU,MAAM;AAEN,UAAAC,IAAa,CAAC,GAAGT,CAAK;AAC5B,IAAAS,EAAW,KAAKf,CAAkB,GAClCU,EAAcK,CAAU;AAAA,EAAA,GACzB,CAACT,CAAK,CAAC;AAEV,QAAMU,IAAa,CACfC,GACAC,GACAC,MACC;AACD,UAAMC,IAAgBC,EAAUJ,GAAYC,GAAYC,GAAUV,CAAU;AAC5E,IAAAL,EAAOgB,CAAa;AAAA,EAAA;AAGxB,2BACKE,GAAY,EAAA,SAASC,GAClB,UAAA,gBAAAC,EAAC,SAAI,WAAU,mBAAkB,gBAAchB,GAC1C,YAAW,IAAI,CAACiB,GAAMC,wBAClBC,GACG,EAAA,UAAA;AAAA,IAAA,gBAAAH;AAAA,MAACI;AAAA,MAAA;AAAA,QAEG,MAAM;AAAA,UACF,YAAYH;AAAA,UACZ,UAAU;AAAA,QACd;AAAA,QACA,QAAQT;AAAA,QACR,QAAQJ;AAAA,MAAA;AAAA,MANH,uBAAuBc,CAAK;AAAA,IAOrC;AAAA,IACA,gBAAAF;AAAA,MAACK;AAAA,MAAA;AAAA,QAEG,cAAAxB;AAAA,QACA,MAAAoB;AAAA,QACA,eAAAlB;AAAA,QACA,QAAAK;AAAA,MAAA;AAAA,MAJKa,EAAK;AAAA,IAKd;AAAA,IACCC,MAAUpB,EAAM,SAAS,KACtB,gBAAAkB;AAAA,MAACI;AAAA,MAAA;AAAA,QAEG,MAAM;AAAA,UACF,YAAYH;AAAA,UACZ,UAAU;AAAA,QACd;AAAA,QACA,QAAQT;AAAA,QACR,QAAQJ;AAAA,MAAA;AAAA,MANH,uBAAuBc,CAAK;AAAA,IAOrC;AAAA,EAAA,EAAA,GA1BO,+BAA+BA,CAAK,EA4BnD,CACH,GACL,EACJ,CAAA;AAER;AACAvB,EAAoB,cAAc;"}