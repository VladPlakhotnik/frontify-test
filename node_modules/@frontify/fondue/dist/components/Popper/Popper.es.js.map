{"version":3,"file":"Popper.es.js","sources":["../../../src/components/Popper/Popper.tsx"],"sourcesContent":["/* (c) Copyright Frontify Ltd., all rights reserved. */\n\nimport {\n    Children,\n    ReactElement,\n    ReactNode,\n    createContext,\n    isValidElement,\n    useContext,\n    useEffect,\n    useMemo,\n    useState,\n} from 'react';\nimport { usePopper } from 'react-popper';\nimport { Portal } from '@components/Portal';\nimport { PopperProps } from '@components/Popper/types';\n\nconst DEFAULT_POPPER_WIDTH = 200;\nconst DEFAULT_POPPER_HEIGHT = 400;\nconst DEFAULT_DIALOG_TOP_POSITION = '100px';\n\nconst PopperContext = createContext<PopperProps>({});\n\nconst Reference = ({ children }: { children: ReactElement }) => {\n    return children;\n};\nReference.displayName = 'FonduePopperReference';\n\nconst Content = ({ children }: { children?: ReactNode }): Nullable<ReactElement> => {\n    const { open } = usePopperContext();\n    // eslint-disable-next-line react/jsx-no-useless-fragment\n    return open ? <>{children}</> : null;\n};\nContent.displayName = 'FonduePopperContent';\n\nconst usePopperContext = () => {\n    const context = useContext(PopperContext);\n    if (!context) {\n        throw new Error('Popper compound components cannot be rendered outside the Popper component');\n    }\n    return context;\n};\n\nexport const Popper = ({\n    children,\n    open,\n    placement = 'bottom-start',\n    offset = [0, 8],\n    flip = true,\n    enablePortal = true,\n    zIndex = 'auto',\n    isDetached = false,\n    verticalAlignment,\n}: PopperProps) => {\n    const [referenceElement, setReferenceElement] = useState<HTMLDivElement | null>(null);\n    const [popperElement, setPopperElement] = useState<HTMLElement | null>(null);\n    const [popperDimensions, setPopperDimensions] = useState({\n        width: DEFAULT_POPPER_WIDTH,\n        height: DEFAULT_POPPER_HEIGHT,\n    });\n\n    const popperInstance = usePopper(isDetached ? document.body : referenceElement, popperElement, {\n        placement,\n        modifiers: [\n            { name: 'offset', options: { offset } },\n            {\n                name: 'flip',\n                enabled: flip,\n            },\n        ],\n    });\n\n    useEffect(() => {\n        const updatePopper = async () => {\n            if (popperInstance.update) {\n                await popperInstance.update();\n                if (popperInstance.state) {\n                    setPopperDimensions({\n                        width: popperInstance.state.rects.popper.width,\n                        height: popperInstance.state.rects.popper.height,\n                    });\n                }\n            }\n        };\n\n        updatePopper().catch(console.error);\n    }, [flip, placement, offset, open]);\n\n    const detachedElementStyles = isDetached\n        ? {\n              left: `${(window.innerWidth - popperDimensions.width) / 2}px`,\n              top:\n                  verticalAlignment === 'top'\n                      ? DEFAULT_DIALOG_TOP_POSITION\n                      : `${(window.innerHeight - popperDimensions.height) / 2}px`,\n              transform: 'none',\n          }\n        : {};\n\n    const value = useMemo(() => ({ open }), [open]);\n    return (\n        <PopperContext.Provider value={value}>\n            {Children.map(children, (child) => {\n                if (isValidElement(child) && typeof child.type === 'function') {\n                    const { name } = child.type;\n\n                    if (name === Reference.name) {\n                        return <div ref={setReferenceElement}>{child}</div>;\n                    }\n\n                    if (name === Content.name) {\n                        return enablePortal ? (\n                            <Portal>\n                                <div\n                                    ref={setPopperElement}\n                                    style={{\n                                        zIndex,\n                                        ...popperInstance.styles.popper,\n                                        ...detachedElementStyles,\n                                    }}\n                                    {...popperInstance.attributes.popper}\n                                >\n                                    {child}\n                                </div>\n                            </Portal>\n                        ) : (\n                            <div\n                                ref={setPopperElement}\n                                style={{ zIndex, ...popperInstance.styles.popper, ...detachedElementStyles }}\n                                {...popperInstance.attributes.popper}\n                            >\n                                {child}\n                            </div>\n                        );\n                    }\n                }\n            })}\n        </PopperContext.Provider>\n    );\n};\nPopper.displayName = 'FonduePopper';\nPopper.Reference = Reference;\nPopper.Content = Content;\n"],"names":["DEFAULT_POPPER_WIDTH","DEFAULT_POPPER_HEIGHT","DEFAULT_DIALOG_TOP_POSITION","PopperContext","createContext","Reference","children","Content","open","usePopperContext","jsx","Fragment","context","useContext","Popper","placement","offset","flip","enablePortal","zIndex","isDetached","verticalAlignment","referenceElement","setReferenceElement","useState","popperElement","setPopperElement","popperDimensions","setPopperDimensions","popperInstance","usePopper","useEffect","detachedElementStyles","value","useMemo","Children","child","isValidElement","name","Portal"],"mappings":";;;;AAiBA,MAAMA,IAAuB,KACvBC,IAAwB,KACxBC,IAA8B,SAE9BC,IAAgBC,EAA2B,CAAA,CAAE,GAE7CC,IAAY,CAAC,EAAE,UAAAC,QACVA;AAEXD,EAAU,cAAc;AAExB,MAAME,IAAU,CAAC,EAAE,UAAAD,QAAiE;AAC1E,QAAA,EAAE,MAAAE,MAASC;AAEV,SAAAD,IAAU,gBAAAE,EAAAC,GAAA,EAAA,UAAAL,EAAA,CAAS,IAAM;AACpC;AACAC,EAAQ,cAAc;AAEtB,MAAME,IAAmB,MAAM;AACrB,QAAAG,IAAUC,EAAWV,CAAa;AACxC,MAAI,CAACS;AACK,UAAA,IAAI,MAAM,4EAA4E;AAEzF,SAAAA;AACX,GAEaE,IAAS,CAAC;AAAA,EACnB,UAAAR;AAAA,EACA,MAAAE;AAAA,EACA,WAAAO,IAAY;AAAA,EACZ,QAAAC,IAAS,CAAC,GAAG,CAAC;AAAA,EACd,MAAAC,IAAO;AAAA,EACP,cAAAC,IAAe;AAAA,EACf,QAAAC,IAAS;AAAA,EACT,YAAAC,IAAa;AAAA,EACb,mBAAAC;AACJ,MAAmB;AACf,QAAM,CAACC,GAAkBC,CAAmB,IAAIC,EAAgC,IAAI,GAC9E,CAACC,GAAeC,CAAgB,IAAIF,EAA6B,IAAI,GACrE,CAACG,GAAkBC,CAAmB,IAAIJ,EAAS;AAAA,IACrD,OAAOxB;AAAA,IACP,QAAQC;AAAA,EAAA,CACX,GAEK4B,IAAiBC,EAAUV,IAAa,SAAS,OAAOE,GAAkBG,GAAe;AAAA,IAC3F,WAAAV;AAAA,IACA,WAAW;AAAA,MACP,EAAE,MAAM,UAAU,SAAS,EAAE,QAAAC,IAAS;AAAA,MACtC;AAAA,QACI,MAAM;AAAA,QACN,SAASC;AAAA,MACb;AAAA,IACJ;AAAA,EAAA,CACH;AAED,EAAAc,EAAU,MAAM;AAaC,KAZQ,YAAY;AAC7B,MAAIF,EAAe,WACf,MAAMA,EAAe,UACjBA,EAAe,SACKD,EAAA;AAAA,QAChB,OAAOC,EAAe,MAAM,MAAM,OAAO;AAAA,QACzC,QAAQA,EAAe,MAAM,MAAM,OAAO;AAAA,MAAA,CAC7C;AAAA,IAET,KAGW,MAAM,QAAQ,KAAK;AAAA,KACnC,CAACZ,GAAMF,GAAWC,GAAQR,CAAI,CAAC;AAElC,QAAMwB,IAAwBZ,IACxB;AAAA,IACI,MAAM,IAAI,OAAO,aAAaO,EAAiB,SAAS,CAAC;AAAA,IACzD,KACIN,MAAsB,QAChBnB,IACA,IAAI,OAAO,cAAcyB,EAAiB,UAAU,CAAC;AAAA,IAC/D,WAAW;AAAA,MAEf,IAEAM,IAAQC,EAAQ,OAAO,EAAE,MAAA1B,MAAS,CAACA,CAAI,CAAC;AAE1C,SAAA,gBAAAE,EAACP,EAAc,UAAd,EAAuB,OAAA8B,GACnB,UAASE,EAAA,IAAI7B,GAAU,CAAC8B,MAAU;AAC/B,QAAIC,EAAeD,CAAK,KAAK,OAAOA,EAAM,QAAS,YAAY;AACrD,YAAA,EAAE,MAAAE,EAAK,IAAIF,EAAM;AAEnB,UAAAE,MAASjC,EAAU;AACnB,eAAQ,gBAAAK,EAAA,OAAA,EAAI,KAAKa,GAAsB,UAAMa,EAAA,CAAA;AAG7C,UAAAE,MAAS/B,EAAQ;AACV,eAAAW,sBACFqB,GACG,EAAA,UAAA,gBAAA7B;AAAA,UAAC;AAAA,UAAA;AAAA,YACG,KAAKgB;AAAA,YACL,OAAO;AAAA,cACH,QAAAP;AAAA,cACA,GAAGU,EAAe,OAAO;AAAA,cACzB,GAAGG;AAAA,YACP;AAAA,YACC,GAAGH,EAAe,WAAW;AAAA,YAE7B,UAAAO;AAAA,UAAA;AAAA,WAET,IAEA,gBAAA1B;AAAA,UAAC;AAAA,UAAA;AAAA,YACG,KAAKgB;AAAA,YACL,OAAO,EAAE,QAAAP,GAAQ,GAAGU,EAAe,OAAO,QAAQ,GAAGG,EAAsB;AAAA,YAC1E,GAAGH,EAAe,WAAW;AAAA,YAE7B,UAAAO;AAAA,UAAA;AAAA,QAAA;AAAA,IAIjB;AAAA,EACH,CAAA,EACL,CAAA;AAER;AACAtB,EAAO,cAAc;AACrBA,EAAO,YAAYT;AACnBS,EAAO,UAAUP;"}