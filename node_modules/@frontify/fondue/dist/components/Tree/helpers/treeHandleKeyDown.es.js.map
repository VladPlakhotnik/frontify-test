{"version":3,"file":"treeHandleKeyDown.es.js","sources":["../../../../src/components/Tree/helpers/treeHandleKeyDown.tsx"],"sourcesContent":["/* (c) Copyright Frontify Ltd., all rights reserved. */\n\nimport { KeyboardEvent } from 'react';\nimport { KeyboardCode } from '@dnd-kit/core';\nimport { TreeState } from '../types';\nimport { ROOT_ID } from '.';\n\nexport const handleKeyDownEvent = (\n    event: KeyboardEvent<HTMLUListElement>,\n    expandedIds: TreeState['expandedIds'],\n    nodes: TreeState['nodes'],\n    handleSelect: (id: string) => void,\n    handleShrink: (id: string) => void,\n    handleExpand: (id: string) => void,\n) => {\n    const activeElement = document.activeElement;\n\n    if (\n        !activeElement?.parentElement ||\n        activeElement.getAttribute('role') !== 'treeitem' ||\n        !(activeElement instanceof HTMLLIElement)\n    ) {\n        return;\n    }\n\n    const items = Array.from(activeElement.parentElement.children).filter(\n        (child) => child.nodeName === 'LI',\n    ) as HTMLLIElement[];\n\n    const currentIndex = items.indexOf(activeElement);\n\n    const node = nodes[currentIndex];\n\n    const id: string = node.props.id;\n    const isExpanded = expandedIds.has(id);\n    const parentId: string | undefined = node.props.parentId;\n    const hasChildren = activeElement.getAttribute('data-has-children') === 'true';\n\n    const { code } = event;\n\n    const toggleSelect = () => {\n        event.preventDefault();\n\n        handleSelect(id);\n    };\n\n    const expandItem = () => {\n        event.preventDefault();\n\n        handleExpand(id);\n    };\n\n    const shrinkItem = () => {\n        event.preventDefault();\n\n        handleShrink(id);\n    };\n\n    const focusPrevious = () => {\n        const previousIndex = (currentIndex + items.length - 1) % items.length;\n        items[previousIndex].focus();\n    };\n\n    const focusNext = () => {\n        const nextIndex = (currentIndex + 1) % items.length;\n        items[nextIndex].focus();\n    };\n\n    switch (code) {\n        case KeyboardCode.Enter:\n            toggleSelect();\n\n            break;\n\n        case KeyboardCode.Space:\n            hasChildren ? expandItem() : toggleSelect();\n\n            break;\n\n        case KeyboardCode.Right:\n            if (!hasChildren) {\n                break;\n            }\n\n            isExpanded ? focusNext() : expandItem();\n\n            break;\n\n        case KeyboardCode.Left:\n            if (hasChildren && isExpanded) {\n                shrinkItem();\n            } else if (parentId && parentId !== ROOT_ID) {\n                const parentIndex = nodes.findIndex((node) => node.props.id === parentId);\n\n                items[parentIndex].focus();\n            }\n            break;\n\n        case KeyboardCode.Up:\n            event.preventDefault();\n            focusPrevious();\n\n            break;\n\n        case KeyboardCode.Down:\n            event.preventDefault();\n            focusNext();\n\n            break;\n\n        default:\n            break;\n    }\n};\n"],"names":["handleKeyDownEvent","event","expandedIds","nodes","handleSelect","handleShrink","handleExpand","activeElement","items","child","currentIndex","node","id","isExpanded","parentId","hasChildren","code","toggleSelect","expandItem","shrinkItem","focusPrevious","previousIndex","focusNext","nextIndex","KeyboardCode","ROOT_ID","parentIndex"],"mappings":";;AAOO,MAAMA,IAAqB,CAC9BC,GACAC,GACAC,GACAC,GACAC,GACAC,MACC;AACD,QAAMC,IAAgB,SAAS;AAG3B,MAAA,EAACA,KAAA,QAAAA,EAAe,kBAChBA,EAAc,aAAa,MAAM,MAAM,cACvC,EAAEA,aAAyB;AAE3B;AAGJ,QAAMC,IAAQ,MAAM,KAAKD,EAAc,cAAc,QAAQ,EAAE;AAAA,IAC3D,CAACE,MAAUA,EAAM,aAAa;AAAA,EAAA,GAG5BC,IAAeF,EAAM,QAAQD,CAAa,GAE1CI,IAAOR,EAAMO,CAAY,GAEzBE,IAAaD,EAAK,MAAM,IACxBE,IAAaX,EAAY,IAAIU,CAAE,GAC/BE,IAA+BH,EAAK,MAAM,UAC1CI,IAAcR,EAAc,aAAa,mBAAmB,MAAM,QAElE,EAAE,MAAAS,EAAS,IAAAf,GAEXgB,IAAe,MAAM;AACvB,IAAAhB,EAAM,eAAe,GAErBG,EAAaQ,CAAE;AAAA,EAAA,GAGbM,IAAa,MAAM;AACrB,IAAAjB,EAAM,eAAe,GAErBK,EAAaM,CAAE;AAAA,EAAA,GAGbO,IAAa,MAAM;AACrB,IAAAlB,EAAM,eAAe,GAErBI,EAAaO,CAAE;AAAA,EAAA,GAGbQ,IAAgB,MAAM;AACxB,UAAMC,KAAiBX,IAAeF,EAAM,SAAS,KAAKA,EAAM;AAC1D,IAAAA,EAAAa,CAAa,EAAE;EAAM,GAGzBC,IAAY,MAAM;AACd,UAAAC,KAAab,IAAe,KAAKF,EAAM;AACvC,IAAAA,EAAAe,CAAS,EAAE;EAAM;AAG3B,UAAQP,GAAM;AAAA,IACV,KAAKQ,EAAa;AACD,MAAAP;AAEb;AAAA,IAEJ,KAAKO,EAAa;AACA,MAAAT,IAAAG,MAAeD;AAE7B;AAAA,IAEJ,KAAKO,EAAa;AACd,UAAI,CAACT;AACD;AAGS,MAAAF,IAAAS,MAAcJ;AAE3B;AAAA,IAEJ,KAAKM,EAAa;AACd,UAAIT,KAAeF;AACJ,QAAAM;eACJL,KAAYA,MAAaW,GAAS;AACnC,cAAAC,IAAcvB,EAAM,UAAU,CAACQ,MAASA,EAAK,MAAM,OAAOG,CAAQ;AAElE,QAAAN,EAAAkB,CAAW,EAAE;MACvB;AACA;AAAA,IAEJ,KAAKF,EAAa;AACd,MAAAvB,EAAM,eAAe,GACPmB;AAEd;AAAA,IAEJ,KAAKI,EAAa;AACd,MAAAvB,EAAM,eAAe,GACXqB;AAEV;AAAA,EAIR;AACJ;"}