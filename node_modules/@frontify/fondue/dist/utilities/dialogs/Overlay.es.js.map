{"version":3,"file":"Overlay.es.js","sources":["../../../src/utilities/dialogs/Overlay.tsx"],"sourcesContent":["/* (c) Copyright Frontify Ltd., all rights reserved. */\n\nimport { useMemoizedId } from '@hooks/useMemoizedId';\nimport { Popper } from '@components/Popper';\nimport { Children, isValidElement, useCallback, useEffect, useRef, useState } from 'react';\nimport { Trigger } from '@utilities/dialogs/Trigger';\nimport { Content } from '@utilities/dialogs/Content';\nimport { OVERLAY_CONTAINER_CLASSES } from '@utilities/overlayStyle';\nimport { BaseDialogProps, Modality, OverlayProps } from '../../types/dialog';\nimport { merge } from '@utilities/merge';\nimport { useFocusTrap } from '@hooks/useFocusTrap';\nimport { useClickOutside } from '@hooks/useClickOutside';\nimport { Portal } from '@components/Portal';\nimport { useDropdownAutoHeight } from '@hooks/useDropdownAutoHeight';\nimport { Z_INDEX_MODAL_BACKDROP } from '@utilities/dialogs/constants';\n\nexport const Overlay = ({\n    open,\n    placement = 'bottom-start',\n    offset = [0, 8],\n    flip = true,\n    enablePortal,\n    children,\n    role = 'region',\n    'data-test-id': dataTestId = 'fondue-overlay',\n    maxWidth = 'auto',\n    maxHeight = 'auto',\n    minWidth = 0,\n    minHeight = 0,\n    handleClose,\n    modality = Modality.NonModal,\n    darkUnderlay,\n    autoHeight,\n    zIndex,\n    isDetached,\n    verticalAlignment,\n}: OverlayProps & BaseDialogProps) => {\n    const id = useMemoizedId();\n    const ref = useRef<HTMLDivElement | null>(null);\n    const [triggerElementRef, setTriggerElementRef] = useState<HTMLDivElement | null>(null);\n    const { maxHeight: maxAutoHeight } = useDropdownAutoHeight(\n        { current: triggerElementRef },\n        { isOpen: open, autoResize: true },\n    );\n\n    const maxContentHeight = autoHeight ? maxAutoHeight : maxHeight;\n    const handleClosingInteraction = useCallback(() => {\n        if (open && modality !== Modality.BlockingModal) {\n            if (handleClose) {\n                handleClose();\n            }\n        }\n    }, [handleClose, modality, open]);\n\n    useFocusTrap(ref.current, open, modality === Modality.NonModal);\n    useClickOutside(ref.current, handleClosingInteraction);\n\n    useEffect(() => {\n        if (open && modality !== Modality.NonModal) {\n            document.body.style.pointerEvents = 'none';\n        }\n        if (!open) {\n            document.body.style.pointerEvents = 'auto';\n        }\n    }, [open, modality]);\n\n    return (\n        <>\n            <Popper\n                data-test-id={dataTestId}\n                open={open}\n                placement={placement}\n                offset={offset}\n                flip={flip}\n                enablePortal={enablePortal}\n                zIndex={zIndex}\n                isDetached={isDetached}\n                verticalAlignment={verticalAlignment}\n            >\n                {Children.map(children, (child) => {\n                    if (isValidElement(child) && typeof child.type === 'function') {\n                        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                        // @ts-ignore Property 'displayName' does not exist on type 'JSXElementConstructor<any>'.ts(2339)\n                        const { displayName } = child.type;\n\n                        if (displayName === Trigger.displayName) {\n                            return (\n                                <Popper.Reference>\n                                    <div id={id} ref={setTriggerElementRef} data-test-id={`${dataTestId}-trigger`}>\n                                        {child}\n                                    </div>\n                                </Popper.Reference>\n                            );\n                        }\n\n                        if (displayName === Content.displayName) {\n                            return (\n                                <Popper.Content>\n                                    <div\n                                        ref={ref}\n                                        data-test-id={`${dataTestId}-content`}\n                                        className={merge([\n                                            'tw-flex tw-flex-col tw-pointer-events-auto',\n                                            OVERLAY_CONTAINER_CLASSES,\n                                        ])}\n                                        role={role}\n                                        id={id}\n                                        aria-hidden={!open}\n                                        aria-labelledby={id}\n                                        style={{ minWidth, minHeight, maxWidth, maxHeight: maxContentHeight }}\n                                    >\n                                        {child}\n                                    </div>\n                                </Popper.Content>\n                            );\n                        }\n                    }\n                })}\n            </Popper>\n\n            {modality !== Modality.NonModal && open && (\n                <Portal>\n                    <div\n                        data-test-id={`${dataTestId}-underlay`}\n                        className={merge([\n                            'tw-fixed tw-top-0 tw-left-0 tw-bottom-0 tw-right-0',\n                            darkUnderlay && 'tw-transition-opacity tw-bg-black tw-opacity-50',\n                        ])}\n                        style={{ zIndex: Z_INDEX_MODAL_BACKDROP }}\n                    />\n                </Portal>\n            )}\n        </>\n    );\n};\n"],"names":["Overlay","open","placement","offset","flip","enablePortal","children","role","dataTestId","maxWidth","maxHeight","minWidth","minHeight","handleClose","modality","Modality","darkUnderlay","autoHeight","zIndex","isDetached","verticalAlignment","id","useMemoizedId","ref","useRef","triggerElementRef","setTriggerElementRef","useState","maxAutoHeight","useDropdownAutoHeight","maxContentHeight","handleClosingInteraction","useCallback","useFocusTrap","useClickOutside","useEffect","jsxs","Fragment","jsx","Popper","Children","child","isValidElement","displayName","Trigger","Content","merge","OVERLAY_CONTAINER_CLASSES","Portal","Z_INDEX_MODAL_BACKDROP"],"mappings":"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"}