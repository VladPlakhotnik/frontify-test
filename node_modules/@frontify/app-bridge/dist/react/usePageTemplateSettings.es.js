import { useState as o, useEffect as m } from "react";
import { useThemeSettings as d } from "./useThemeSettings.es.js";
const v = (i, s, n) => {
  const { themeSettings: r } = d(i), [a, S] = o(null), [T, l] = o(!1), [u, c] = o([]), [p, f] = o(null);
  return m(() => {
    const t = (e) => {
      S({ ...e.pageTemplateSettings });
    };
    return (async () => {
      l(!0);
      let e = null;
      if (s === "cover")
        e = await i.getCoverPageTemplateSettings();
      else if (n === void 0) {
        console.error(`Document ID is required for ${s} template settings`), f(null), l(!1);
        return;
      } else
        s === "documentPage" ? e = await i.getDocumentPageTemplateSettings(n) : s === "library" && (e = await i.getLibraryPageTemplateSettings(n));
      l(!1), S(e);
    })(), window.emitter.on("AppBridge:PageTemplateSettingsUpdated", t), () => {
      window.emitter.off("AppBridge:PageTemplateSettingsUpdated", t);
    };
  }, [i, n, s]), m(() => {
    if (!r || !a)
      return;
    const t = [], g = { ...a };
    for (const e of Object.keys(r))
      a[e] !== null && a[e] !== void 0 ? t.push(e) : g[e] = r[e];
    c(t), f(g);
  }, [r, a]), {
    pageTemplateSettings: p,
    customizedPageTemplateSettingsKeys: u,
    updatePageTemplateSettings: async (t) => {
      try {
        if (s === "cover")
          await i.updateCoverPageTemplateSettings(t);
        else if (n === void 0) {
          console.error(`Document ID is required for ${s} template settings`), l(!1);
          return;
        } else
          s === "documentPage" ? await i.updateDocumentPageTemplateSettings(
            n,
            t
          ) : s === "library" && await i.updateLibraryPageTemplateSettings(n, t);
        window.emitter.emit("AppBridge:PageTemplateSettingsUpdated", {
          pageTemplateSettings: {
            ...a,
            ...t
          }
        });
      } catch (g) {
        console.error(g);
      }
    },
    isLoading: T
  };
};
export {
  v as usePageTemplateSettings
};
//# sourceMappingURL=usePageTemplateSettings.es.js.map
